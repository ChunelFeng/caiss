<p align="left">
  <a href="https://github.com/ChunelFeng/caiss"><img src="https://badgen.net/badge/langs/C++,Python,Java,CSharp/cyan?list=1" alt="languages"></a>
  <a href="https://github.com/ChunelFeng/caiss"><img src="https://badgen.net/badge/os/MacOS,Linux,Windows/cyan?list=1" alt="os"></a>
  <a href="https://github.com/ChunelFeng/caiss"><img src="https://badgen.net/badge/support/sdk,sql,restful/cyan?list=1" alt="support"></a><br>
  <a href="https://github.com/ChunelFeng/caiss/stargazers"><img src="https://badgen.net/github/stars/ChunelFeng/caiss?color=cyan" alt="stars"></a>
  <a href="https://github.com/ChunelFeng/caiss/network/members"><img src="https://badgen.net/github/forks/ChunelFeng/caiss?color=cyan" alt="forks"></a>
  <a href="http://www.chunel.cn"><img src="https://badgen.net/badge/ğŸ”¥/forum/cyan" alt="forum"></a>
  <a href="https://hub.docker.com/r/chunelfeng/caiss"><img src="https://badgen.net/badge/ğŸ³/docker/cyan?list=1" alt="docker"></a>
  <a href="http://www.chunel.cn:3001/"><img src="https://badgen.net/badge/ğŸ‘€/web/cyan" alt="web"></a>
  <a href="https://github.com/ChunelFeng/caiss"><img src="https://badgen.net/badge/ğŸŒŸ/github/cyan" alt="github"></a>
  </a>
</p>

<h1 align="center">
  Caissè¯´æ˜æ–‡æ¡£
</h1>

## ä¸€. ç®€ä»‹

&emsp;&emsp;éšç€äººå·¥æ™ºèƒ½æŠ€æœ¯çš„æ™®åŠï¼Œæµ·é‡é«˜ç»´åº¦å‘é‡çš„ç›¸ä¼¼åº¦æŸ¥è¯¢æŠ€æœ¯åœ¨ç ”ç©¶å’Œç”Ÿäº§ä¸­çš„ä½œç”¨å’Œé‡è¦æ€§ä¸æ—¥ä¿±å¢ã€‚ç›®å‰ï¼Œå¸‚é¢æœ‰è®¸å¤šä¼˜ç§€å¼€æºçš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼š
* ç”±äºå¯¹äºå„ç§ç®—æ³•åŸç†çš„äº†è§£ä¸æ·±ï¼Œä¸ä¼šè°ƒæ•´å‚æ•°ï¼Œå¯¼è‡´çš„è®­ç»ƒæ¨¡å‹ç»“æœåå·®è¾ƒå¤§ã€‚
* å¼€æºåº“å¯¹äºå„ç§è·ç¦»çš„æ”¯æŒæœ‰é™ï¼Œæ— æ³•æ»¡è¶³éšæ—¶å˜åŒ–çš„å®éªŒéœ€æ±‚ã€‚
* æ ‡ç­¾ä¿¡æ¯å’Œå‘é‡çš„åˆ†ç¦»ï¼Œå¯¼è‡´æ ‡è®°å’ŒæŸ¥è¯¢éœ€è¦åœ¨ä¸åŒçš„æ­¥éª¤ä¸­å®Œæˆã€‚
* åŠŸèƒ½ä¸å¤Ÿå…¨é¢ï¼Œæ— æ³•è¦†ç›–æ—¥å¸¸éœ€è¦çš„"å¢åˆ æ”¹æŸ¥"åŠŸèƒ½ã€‚
* éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼Œå¯¹äºå¹³å°æˆ–è€…å¯¹äºç¼–ç¨‹è¯­è¨€çš„ä¾èµ–ï¼Œå¯¼è‡´äº†å„ç§ç¯å¢ƒé—®é¢˜ã€‚

&emsp;&emsp;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åŸºäºGoogleï¼ŒFacebookï¼ŒAlibabaç­‰ç§‘æŠ€å·¨å¤´çš„ç°æœ‰æˆæœï¼Œå®ç°äº†ä¸€å¥—å…¨æ–°æ€è·¯çš„æµ·é‡æ•°æ®æ£€ç´¢å¼€æºè§£å†³æ–¹æ¡ˆã€‚æä¾›é¢å‘æœ€ç»ˆç»“æœçš„è®­ç»ƒæ–¹æ³•ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ ¹æ®è®¾å®šçš„ç›®æ ‡è‡ªåŠ¨è°ƒèŠ‚å‚æ•°ã€‚æä¾›å¸¸ç”¨è·ç¦»å’Œè‡ªå®šä¹‰è·ç¦»çš„è®­ç»ƒå’ŒæŸ¥è¯¢æ–¹å¼ã€‚æ”¯æŒç¼“å­˜å’Œå¤šçº¿ç¨‹è°ƒç”¨ï¼Œæ”¯æŒæ‰¹é‡æŸ¥è¯¢åŠŸèƒ½ã€‚æä¾›çº¯Cé£æ ¼çš„SDKæ¥å£ï¼Œæä¾›å¤šç§è¯­è¨€ï¼ˆå¦‚ï¼šPythonï¼ŒJavaï¼ŒC#ï¼‰çš„ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€SQLè¯­æ³•è¿›è¡Œå¢åˆ æŸ¥æ”¹ï¼Œæ”¯æŒMacOSï¼ŒLinuxå’ŒWindowsç³»ç»Ÿã€‚æä¾›äº†è¯¦ç»†çš„Demoç¤ºä¾‹ï¼Œå¹¶æä¾›äº†Dockeré•œåƒå’ŒWebé¡µé¢å±•ç¤ºã€‚

&emsp;&emsp;æˆ‘ä»¬æŠŠè¿™å¥—è§£å†³æ–¹æ¡ˆï¼Œå‘½åä¸ºCaiss(Chunel Artificial Intelligence Similarity Search)ã€‚ç»è¿‡å®æµ‹ï¼Œå®ƒå¯ä»¥åœ¨ä¿æŒè¶…é«˜å‡†ç¡®ç‡çš„æƒ…å†µä¸‹ï¼Œæå¤§çš„é™ä½æŸ¥è¯¢è€—æ—¶ã€‚ä¸”éšç€æ•°æ®é‡çš„å¢åŠ ï¼Œå…¶æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ä¼šæ›´åŠ æ˜æ˜¾ã€‚å¸Œæœ›å®ƒå¯ä»¥åœ¨å¤§å®¶çš„ç ”ç©¶å’Œç”Ÿäº§è¿‡ç¨‹ä¸­ï¼Œå‘æŒ¥ç§¯æçš„ä½œç”¨ã€‚

&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ![Caiss Logo](https://github.com/ChunelFeng/caiss/blob/master/doc/image/Caiss%20Logo.jpg)


## äºŒ. ç¼–è¯‘è¯´æ˜

* Caissåœ¨Mac(MacOS-10.15ï¼Œä¸»ç¯å¢ƒ)ï¼ŒLinuxï¼ˆUbuntu-20.04ï¼‰å’ŒWindowsï¼ˆWindows-10ï¼‰ä¸Šå¼€å‘ï¼Œä½¿ç”¨çš„IDEå‡æ˜¯CLionã€‚ä½¿ç”¨Clionè¯»å–CMakeList.txtæ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆå¯¹åº”å·¥ç¨‹ï¼Œå°†CMakeList.txtæ–‡ä»¶ä¸­ã€MY_BOOST_PATHã€‘å’Œã€MY_EIGEN_PATHã€‘ä¿®æ”¹ä¸ºæ–°ç¯å¢ƒä¸­booståº“å’Œeigenåº“çš„ä½ç½®ï¼Œå³å¯å®Œæˆç¼–è¯‘ã€‚
* Linuxç¯å¢ƒå¼€å‘è€…ï¼ˆä»¥C++ä¸ºä¾‹ï¼‰ï¼Œå‘½ä»¤è¡Œæ¨¡å¼ä¸‹ï¼Œè¾“å…¥:
  ```shell
  $ git clone https://github.com.cnpmjs.org/ChunelFeng/caiss.git    # ä¸‹è½½ä»£ç è‡³æœ¬åœ°
  $ cd caiss/
  $ ./caiss-linux-env.sh                     # ä¸€é”®å®‰è£…Caissåœ¨Linuxï¼ˆUbuntuï¼‰ä¸Šçš„è¿è¡Œç¯å¢ƒ    
  $ cmake .                                  # æ³¨æ„ï¼Œcmakeåé¢æœ‰ä¸€ä¸ª"."ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•    
  $ make                                     # å³å¯å®Œæˆç¼–è¯‘    
  $ cd caissDemo/    
  $ ./CaissDemo                              # å³å¯æŸ¥çœ‹C++ç‰ˆæœ¬demoçš„è¿è¡Œç»“æœ    
  ```
* Dockerç¯å¢ƒå¼€å‘è€…ï¼ˆä»¥Pythonä¸ºä¾‹ï¼‰ï¼Œè¾“å…¥:
  ```shell
  $ docker pull chunelfeng/caiss                        # è·å–Caissçš„æœ€æ–°Dockerç‰ˆæœ¬
  $ docker run -it --name CaissDemo chunelfeng/caiss    # å¯åŠ¨å®¹å™¨ï¼Œå¹¶è¿›å…¥å†…éƒ¨ç¯å¢ƒ
  $ cmake .                                             # æ³¨æ„ï¼Œcmakeåé¢æœ‰ä¸€ä¸ª"."ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•
  $ make 
  $ cd python/    
  $ python3 pyCaissDemo.py                              # å³å¯æŸ¥çœ‹pythonç‰ˆæœ¬demoçš„è¿è¡Œç»“æœ
  ```
* Windowsä¸Šï¼Œå¼€å‘ç¯å¢ƒä¸ºVisual Studioçš„C++å¼€å‘è€…ï¼Œè¯·ä½¿ç”¨[feature/for-windows-visual-studio]åˆ†æ”¯ï¼Œé€šè¿‡CMakeList.txtæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„*.slnæ–‡ä»¶ï¼Œç„¶åé€šè¿‡Visual Studioæ‰“å¼€ï¼Œå³å¯å®Œæˆç¼–è¯‘ã€‚
* Webç«¯æˆ–è€…ç§»åŠ¨ç«¯ï¼Œå¯ä»¥ç‚¹å‡»è¿›å…¥ [Caiss ç½‘é¡µç‰ˆ](http://www.chunel.cn:3001) æŸ¥çœ‹ç®€æ˜“å±•ç¤ºæ•ˆæœã€‚ç½‘é¡µç‰ˆæš‚æ—¶ä»…æ”¯æŒè‹±æ–‡å•è¯çš„ç›¸ä¼¼è¯­ä¹‰è¯è¯­æŸ¥è¯¢ï¼Œå¤šè¯æŸ¥è¯¢è¯·ä½¿ç”¨"|"åˆ†éš”ï¼Œä¾‹ï¼šhello|world
* å¦‚æœåœ¨ç¼–è¯‘æˆ–ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿éšæ—¶è”ç³»æˆ‘ä»¬ï¼ˆè”ç³»æ–¹å¼è§é™„å½•ï¼‰ã€‚æˆ‘ä»¬å¾ˆä¹æ„è·Ÿæ‚¨ä¸€èµ·æ¢è®¨å’Œè§£å†³ä½¿ç”¨è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„ä»»ä½•é—®é¢˜ï¼Œå¹¶æºæ‰‹åšè¿›ä¸€æ­¥ä¼˜åŒ–ã€‚

![Caiss ç½‘é¡µç‰ˆç•Œé¢](https://github.com/ChunelFeng/caiss/blob/master/doc/image/Caiss%20Web.png)


## ä¸‰. è®­ç»ƒæµç¨‹

1ï¼Œå®‰è£…python3ç¯å¢ƒï¼Œå®‰è£…tensorflowåº“ï¼Œå®‰è£…kerasåº“ï¼Œå®‰è£…keras-bertåº“ï¼Œå®‰è£…numpyåº“ï¼Œå®‰è£…pprintåº“ã€‚

2ï¼Œæ ¹æ®éœ€æ±‚ï¼Œä¸‹è½½å¯¹åº”çš„bertæ¨¡å‹å¹¶è§£å‹è‡³æœ¬åœ°ã€‚bertæ¨¡å‹ä¸‹è½½ï¼Œè¯·å‚è€ƒé“¾æ¥ï¼š[bertå…¥é—¨èµ„æ–™å’Œæ¨¡å‹ä¸‹è½½åœ°å€](http://chunel.cn/archives/knowledge-of-bert)ã€‚

3ï¼Œå‡†å¤‡å¾…embeddingçš„æ–‡æœ¬æ–‡ä»¶ã€‚æ¯”å¦‚ï¼Œè‹±æ–‡å•è¯çš„ç›¸ä¼¼è¯æŸ¥è¯¢ä»»åŠ¡ï¼Œå°†ä¸åŒçš„å•è¯æŒ‰è¡Œåˆ†å¼€å³å¯ã€‚å…·ä½“æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
  ```shell script
  one
  two
  three
  four
  ```

4ï¼Œæ‰§è¡Œ/python/dataProcess/pyCaissTrainDataBuilder.pyä¸­ä¸‹çš„__main__æ–¹æ³•ã€‚æ‰§è¡Œå‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µï¼Œä¿®æ”¹å¾…embeddingæ–‡æœ¬çš„ä½ç½®(embedding_file_path)ï¼Œbertæ¨¡å‹çš„ä½ç½®(bert_model_path)ã€‚å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä¼šåœ¨result_pathä½ç½®ï¼Œç”Ÿæˆå¯ç”¨äºCaissè®­ç»ƒçš„æ–‡æœ¬å†…å®¹ã€‚å…·ä½“æ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
  ```shell script
  {"one": ["1.0", "0.0", "0.0", "0.0"]}
  {"two": ["0.0", "1.0", "0.0", "0.0"]}
  {"three": ["0.0", "0.0", "1.0", "0.0"]}
  {"four": ["0.0", "0.0", "0.0", "1.0"]}
  ```

5ï¼Œå‚è€ƒä¸‹æ–‡ç¬¬5éƒ¨åˆ†å…³äºCaissçš„ä½¿ç”¨demoï¼Œå¼€å§‹è®­ç»ƒã€æŸ¥è¯¢ç­‰åŠŸèƒ½å§ã€‚

![Caiss æ¶æ„è®¾è®¡å›¾](https://github.com/ChunelFeng/caiss/blob/master/doc/image/Caiss%20Skeleton.png)

## å››. æ¥å£å®šä¹‰
```cpp
/**
 * åˆå§‹åŒ–ç¯å¢ƒä¿¡æ¯
 * @param maxThreadSize æ”¯æŒçš„æœ€å¤§å¹¶å‘æ•°
 * @param algoType ç®—æ³•ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @param manageType å¹¶å‘ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_Environment(CAISS_UINT maxThreadSize = 1,
                            CAISS_ALGO_TYPE algoType = CAISS_ALGO_DEFAULT,
                            CAISS_MANAGE_TYPE manageType = CAISS_MANAGE_DEFAULT);

/**
 * åˆ›å»ºå¥æŸ„ä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_CreateHandle(CAISS_HANDLE *handle);

/**
 * åˆå§‹åŒ–ä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param mode å¤„ç†ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @param distanceType è·ç¦»ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @param dim ç»´åº¦
 * @param modelPath æ¨¡å‹è·¯å¾„
 * @param distFunc è·ç¦»è®¡ç®—å‡½æ•°ï¼ˆä»…é’ˆå¯¹è‡ªå®šä¹‰è·ç¦»è®¡ç®—ç”Ÿæ•ˆï¼‰
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_Init(CAISS_HANDLE handle,
                     CAISS_MODE mode,
                     CAISS_DISTANCE_TYPE distanceType,
                     CAISS_UINT dim,
                     CAISS_STRING modelPath,
                     CAISS_DIST_FUNC distFunc = nullptr);

/**
 * æ¨¡å‹è®­ç»ƒåŠŸèƒ½
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param dataPath å¾…è®­ç»ƒæ ·æœ¬è·¯å¾„ï¼ˆè®­ç»ƒæ–‡ä»¶æ ¼å¼ï¼Œå‚è€ƒ/doc/æ–‡ä»¶å¤¹ä¸‹demo_2500words_768dim.txtçš„æ ¼å¼ï¼‰
 * @param maxDataSize æœ€å¤§æ ·æœ¬ä¸ªæ•°
 * @param normalize æ ·æœ¬æ•°æ®æ˜¯å¦å½’ä¸€åŒ–
 * @param maxIndexSize æ ·æœ¬æ ‡ç­¾æœ€å¤§é•¿åº¦
 * @param precision ç›®æ ‡ç²¾ç¡®åº¦
 * @param fastRank å¿«é€ŸæŸ¥è¯¢æ’åä¸ªæ•°
 * @param realRank çœŸå®æŸ¥è¯¢æ’åä¸ªæ•°
 * @param step è¿­ä»£æ­¥å¾„
 * @param maxEpoch æœ€å¤§è¿­ä»£è½®æ•° ï¼ˆmaxEpochè½®åï¼Œå‡†ç¡®ç‡ä»ä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™åœæ­¢è®­ç»ƒï¼Œè¿”å›è­¦å‘Šä¿¡æ¯ï¼‰
 * @param showSpan ä¿¡æ¯æ‰“å°è¡Œæ•°
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 * @notice å½“å¿«é€ŸæŸ¥è¯¢fastRankä¸ªæ•°ï¼Œå‡åœ¨çœŸå®realRankä¸ªæ•°çš„èŒƒå›´å†…çš„å‡†ç¡®ç‡ï¼Œè¶…è¿‡precisionçš„æ—¶å€™ï¼Œè®­ç»ƒå®Œæˆ
 */
CAISS_API CAISS_Train(CAISS_HANDLE handle,
                      CAISS_STRING dataPath,
                      CAISS_UINT maxDataSize,
                      CAISS_BOOL normalize,
                      CAISS_UINT maxIndexSize = 64,
                      CAISS_FLOAT precision = 0.95,
                      CAISS_UINT fastRank = 5,
                      CAISS_UINT realRank = 5,
                      CAISS_UINT step = 1,
                      CAISS_UINT maxEpoch = 5,
                      CAISS_UINT showSpan = 1000);

/**
 * æŸ¥è¯¢åŠŸèƒ½
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param info å¾…æŸ¥è¯¢çš„ä¿¡æ¯
 * @param searchType æŸ¥è¯¢ä¿¡æ¯çš„ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @param topK è¿”å›æœ€è¿‘çš„topKä¸ªä¿¡æ¯
 * @param filterEditDistance éœ€è¦è¿‡æ»¤çš„æœ€å°è¯è¯­ç¼–è¾‘è·ç¦»
 * @param searchCBFunc æŸ¥è¯¢åˆ°ç»“æœåï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œä¼ å…¥çš„æ˜¯æŸ¥è¯¢åˆ°ç»“æœçš„wordä¿¡æ¯å’Œdistanceä¿¡æ¯
 * @param cbParams å›è°ƒå‡½æ•°ä¸­ï¼Œä¼ å…¥çš„å‚æ•°ä¿¡æ¯
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 * @notice filterEditDistanceä»…é’ˆå¯¹æ ¹æ®å•è¯è¿‡æ»¤çš„æƒ…å†µä¸‹ç”Ÿæ•ˆã€‚
 *         =-1è¡¨ç¤ºä¸è¿‡æ»¤ï¼›=0è¡¨ç¤ºè¿‡æ»¤è·Ÿå½“å‰è¯è¯­å®Œå…¨ç›¸åŒçš„ï¼›
 *         =3è¡¨ç¤ºè¿‡æ»¤è·Ÿå½“å‰è¯è¯­ç›¸ç¼–è¾‘è·ç¦»çš„åœ¨3ä»¥å†…çš„ï¼Œä»¥æ­¤ç±»æ¨ï¼›
 *         æœ€å¤§å€¼ä¸è¶…è¿‡CAISS_MAX_EDIT_DISTANCEå€¼
 */
CAISS_API CAISS_Search(CAISS_HANDLE handle,
                       void *info,
                       CAISS_SEARCH_TYPE searchType,
                       CAISS_UINT topK,
                       CAISS_UINT filterEditDistance = CAISS_DEFAULT_EDIT_DISTANCE,
                       CAISS_SEARCH_CALLBACK searchCBFunc = nullptr,
                       const void *cbParams = nullptr);

/**
 * è·å–ç»“æœå­—ç¬¦ä¸²é•¿åº¦
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param size ç»“æœé•¿åº¦
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_GetResultSize(CAISS_HANDLE handle,
                              CAISS_UINT &size);

/**
 * è·å–æŸ¥è¯¢ç»“æœä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param result ç»“æœä¿¡æ¯
 * @param size å¯¹åº”ç»“æœé•¿åº¦
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_GetResult(CAISS_HANDLE handle,
                          char *result,
                          CAISS_UINT size);

/**
 * æ’å…¥ä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param node å¾…æ’å…¥çš„å‘é‡ä¿¡æ¯
 * @param label å¾…æ’å…¥å‘é‡çš„æ ‡ç­¾ä¿¡æ¯
 * @param insertType æ’å…¥ç±»å‹ï¼ˆè¯¦è§CaissLibDefine.hæ–‡ä»¶ï¼‰
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 * @notice æ’å…¥ä¿¡æ¯å®æ—¶ç”Ÿæ•ˆã€‚ç¨‹åºç»“æŸåï¼Œæ˜¯å¦ä¿å­˜æ–°æ’å…¥çš„ä¿¡æ¯ï¼Œå–å†³äºæ˜¯å¦è°ƒç”¨CAISS_Save()æ–¹æ³•
 */
CAISS_API CAISS_Insert(CAISS_HANDLE handle,
                       CAISS_FLOAT *node,
                       CAISS_STRING label,
                       CAISS_INSERT_TYPE insertType);

/**
 * å¿½ç•¥ä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param label å¾…å¿½ç•¥çš„æ ‡ç­¾ä¿¡æ¯
 * @param isIgnore è¡¨ç¤ºå¿½ç•¥ï¼ˆtrueï¼‰æˆ–è€…ä¸å†å¿½ç•¥ï¼ˆfalseï¼‰
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_Ignore(CAISS_HANDLE handle,
                       CAISS_STRING label,
                       CAISS_BOOL isIgnore = CAISS_TRUE);

/**
 * ä¿å­˜æ¨¡å‹
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param modelPath æ¨¡å‹ä¿å­˜è·¯å¾„ï¼ˆé»˜è®¤å€¼æ˜¯è¦†ç›–å½“å‰æ¨¡å‹ï¼‰
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_Save(CAISS_HANDLE handle,
                     CAISS_STRING modelPath = nullptr);

/**
 * æ‰§è¡ŒsqlæŒ‡ä»¤
 * @param handle å¥æŸ„ä¿¡æ¯
 * @param sql æŸ¥è¯¢çš„sqlè¯­å¥
 * @param sqlCBFunc æ‰§è¡Œsqlè¿‡ç¨‹ä¸­ï¼Œè§¦å‘çš„å›è°ƒå‡½æ•°
 * @param sqlParams ä¼ å…¥çš„æ¡ä»¶ä¿¡æ¯
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_ExecuteSQL(CAISS_HANDLE handle,
                           CAISS_STRING sql,
                           CAISS_SEARCH_CALLBACK sqlCBFunc = nullptr,
                           const void *sqlParams = nullptr);

/**
 * é”€æ¯å¥æŸ„ä¿¡æ¯
 * @param handle å¥æŸ„ä¿¡æ¯
 * @return è¿è¡ŒæˆåŠŸè¿”å›0ï¼Œè­¦å‘Šè¿”å›1ï¼Œå…¶ä»–å¼‚å¸¸å€¼ï¼Œå‚è€ƒé”™è¯¯ç å®šä¹‰
 */
CAISS_API CAISS_DestroyHandle(CAISS_HANDLE handle);
```

## äº”. ä½¿ç”¨Demo
```cpp
/*
* æ›´å¤šä½¿ç”¨æ ·ä¾‹ï¼Œè¯·å‚è€ƒcaissDemoæ–‡ä»¶å¤¹ä¸­å†…å®¹ã€‚
* ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè¯·å¯¹æ¯ä¸ªCAISS_*å‡½æ•°çš„è¿”å›å€¼è¿›è¡Œåˆ¤æ–­å’Œå¤„ç†ã€‚
* docæ–‡ä»¶å¤¹ä¸­ï¼Œæä¾›äº†demo_2500words_768dim.txtæ–‡ä»¶ã€‚
* å¦‚æœéœ€è¦è®­ç»ƒæ–°çš„Caissæ¨¡å‹ï¼Œè¯·æ ¹æ®æ­¤æ–‡ä»¶çš„æ ·å¼ï¼Œç”Ÿæˆæ–°çš„è¯å‘é‡æ–‡ä»¶ã€‚
*/

#include <iostream>
#include "CaissLib.h"


static const CAISS_UINT max_thread_num_ = 1;    // çº¿ç¨‹æ•°é‡
static const CAISS_ALGO_TYPE algo_type_ = CAISS_ALGO_HNSW;
static const CAISS_MANAGE_TYPE manage_type_ = CAISS_MANAGE_SYNC;
static const CAISS_MODE mode_ = CAISS_MODE_PROCESS;
static const CAISS_DISTANCE_TYPE dist_type_ = CAISS_DISTANCE_INNER;
static const CAISS_UINT dim_ = 768;    // å‘é‡ç»´åº¦
static const CAISS_STRING model_path_ = "./demo_2500words_768dim.caiss";    // caissæ¨¡å‹è·¯å¾„
static const CAISS_DIST_FUNC dist_func_ = nullptr;
static const CAISS_STRING info_ = "water";    // å¤šè¯æŸ¥è¯¢çš„æƒ…å†µä¸‹ï¼Œè¾“å…¥ä½¿ç”¨"|"åˆ†éš”ã€‚ä¾‹ï¼š"hello|world"
static const CAISS_SEARCH_TYPE search_type_ = CAISS_SEARCH_WORD;
static const CAISS_UINT top_k_ = 5;

static const CAISS_STRING data_path_ = "./demo_2500words_768dim.txt";    // caissè®­ç»ƒæ–‡ä»¶è·¯å¾„
static const CAISS_UINT max_data_size_ = 5000;    // å»ºè®®ç•¥å¤§äºè®­ç»ƒæ ·æœ¬ä¸­çš„è¡Œæ•°ï¼Œæ–¹ä¾¿ä»Šåæ’å…¥æ•°æ®çš„æ›´æ–°
static const CAISS_BOOL normalize_ = CAISS_TRUE;    // æ˜¯å¦å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼ˆå¸¸ç”¨äºè®¡ç®—cosè·ç¦»ï¼‰
static const CAISS_UINT max_index_size_ = 64;     // æ ‡ç­¾çš„æœ€å¤§é•¿åº¦
static const CAISS_FLOAT precision_ = 0.98f;    // æ¨¡å‹ç²¾ç¡®åº¦
static const CAISS_UINT fast_rank_ = 5;
static const CAISS_UINT real_rank_ = 5;
static const CAISS_UINT step_ = 1;
static const CAISS_UINT max_epoch_ = 3;
static const CAISS_UINT show_span_ = 1000;

static CAISS_STATUS train() {
    /* è®­ç»ƒåŠŸèƒ½ */
    CAISS_STATUS ret = CAISS_RET_OK;

    CAISS_HANDLE handle = nullptr;
    ret = CAISS_CreateHandle(&handle);

    ret = CAISS_Init(handle, CAISS_MODE_TRAIN, dist_type_, dim_, model_path_, dist_func_);

    ret = CAISS_Train(handle, data_path_, max_data_size_, normalize_, max_index_size_,
            precision_, fast_rank_, real_rank_, step_, max_epoch_, show_span_);

    ret = CAISS_DestroyHandle(handle);
    return ret;
}

static CAISS_STATUS search() {
    /* æŸ¥è¯¢åŠŸèƒ½ */
    CAISS_STATUS ret = CAISS_RET_OK;

    CAISS_HANDLE handle = nullptr;
    ret = CAISS_CreateHandle(&handle);

    ret = CAISS_Init(handle, CAISS_MODE_PROCESS, dist_type_, dim_, model_path_, dist_func_);

    ret = CAISS_Search(handle, (void *)info_, search_type_, top_k_);

    unsigned int size = 0;
    ret = CAISS_GetResultSize(handle, size);

    char *result = new char[size + 1];
    memset(result, 0, size + 1);
    ret = CAISS_GetResult(handle, result, size);
    std::cout << result << std::endl;    // è¾“å‡ºç»“æœæ ¼å¼ï¼Œè§ä¸‹æ–‡
    delete [] result;

    ret = CAISS_DestroyHandle(handle);

    return ret;
}

int main() {
    /* ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè¯·æ³¨æ„æ·»åŠ é’ˆå¯¹è¿”å›å€¼retçš„åˆ¤å®š */
    CAISS_STATUS ret = CAISS_RET_OK;
    ret = CAISS_Environment(max_thread_num_, algo_type_, manage_type_);
    if (CAISS_RET_OK != ret) {
        return ret;    // é’ˆå¯¹CAISS_*å‡½æ•°è¿”å›å€¼ï¼Œè¿›è¡Œå¼‚å¸¸åˆ¤å®š
    }

    ret = train();
    ret = search();
    return 0;
}
```


## å…­. è¾“å‡ºå†…å®¹

* è®­ç»ƒæ¥å£æ‰§è¡Œå®Œæ¯•åï¼Œä¼šåœ¨å¯¹åº”çš„ç›®å½•ä¸‹ç”Ÿæˆ *.caiss æ¨¡å‹æ–‡ä»¶ã€‚ä¸åŒæ“ä½œæ“ä½œç³»ç»Ÿä¹‹é—´ç”Ÿæˆçš„æ¨¡å‹æ–‡ä»¶ï¼Œä¸èƒ½æ··ç”¨ã€‚å¦‚éœ€è·¨å¹³å°ä½¿ç”¨ï¼Œè¯·é‡æ–°è®­ç»ƒã€‚
* æŸ¥è¯¢ç»“æœè¾“å‡ºï¼Œä¸ºæ ‡å‡†jsonæ ¼å¼ã€‚ä¾‹ï¼šæŸ¥è¯¢è¯è¯­waterï¼ŒtopK=5ï¼Œè¿”å›ç›¸ä¼¼è¯è¯­ä¸ºï¼š[food,glass,light,alcohol,liquid]è¿™5ä¸ªè¯è¯­ã€‚è€—æ—¶ä¿¡æ¯å•ä½ä¸ºå¾®ç§’ã€‚æŸ¥è¯¢ç»“æœä¿¡æ¯å¦‚ä¸‹ï¼š

```json
{
    "version":"3.0.0",
    "size":5,
    "distance_type":"inner",
    "search_type":"ann_search",
    "ann_ts":2692,
    "search_ts":3721,
    "algo_type":"hnsw",
    "result":[
        {
            "query":"water",
            "details":[
                {
                    "distance":0.10039210319519043,
                    "index":641,
                    "label":"food"
                },
                {
                    "distance":0.10391676425933838,
                    "index":1812,
                    "label":"glass"
                },
                {
                    "distance":0.11682325601577759,
                    "index":361,
                    "label":"light"
                },
                {
                    "distance":0.12232851982116699,
                    "index":2163,
                    "label":"alcohol"
                },
                {
                    "distance":0.12482517957687378,
                    "index":2281,
                    "label":"liquid"
                }
            ]
        }
    ]
}
```


## ä¸ƒ. å…¶ä»–

* è®­ç»ƒåŠŸèƒ½ä»…æ”¯æŒå•çº¿ç¨‹ã€‚æŸ¥è¯¢ã€æ’å…¥ã€ä¿®æ”¹å’Œåˆ é™¤ç­‰åŠŸèƒ½ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¹¶å‘ã€‚
* æ’å…¥ã€ä¿®æ”¹æˆ–åˆ é™¤æ•°æ®ï¼Œå®æ—¶ç”Ÿæ•ˆã€‚è¿›ç¨‹é‡å¯åæ˜¯å¦ç”Ÿæ•ˆï¼Œå–å†³äºæ˜¯å¦è°ƒç”¨saveæ–¹æ³•ã€‚
* åœ¨å¼‚æ­¥æ¨¡å¼ä¸‹ï¼ŒæŸ¥è¯¢ã€æ’å…¥ç­‰éœ€è¦ä¼ å…¥å‘é‡ä¿¡æ¯çš„æ–¹æ³•ä¸­ï¼Œè¯·è‡ªè¡Œä¿è¯ä¼ å…¥çš„å‘é‡æ•°æ®åœ¨å†…å­˜ä¸­æŒç»­å­˜åœ¨ï¼Œç›´è‡³ç»“æœç”Ÿæ•ˆä¸ºæ­¢ã€‚
* Caissçš„æºä»£ç ï¼Œå‘å¸ƒåœ¨ï¼šhttps://github.com/ChunelFeng/caiss ï¼ŒæŠ€æœ¯äº¤æµè®ºå›åœ°å€ï¼š[ä¸€é¢ä¹‹çŒ¿ç½‘](http://www.chunel.cn)ï¼Œæ¬¢è¿éšæ—¶äº¤æµæŒ‡å¯¼å’Œè´¡çŒ®ä»£ç ã€‚å¦‚æœ‰ä½¿ç”¨éœ€æ±‚ï¼Œå‘¨æœ«å¯æä¾›æ”¯æŒæœåŠ¡ã€‚
* æ„Ÿè°¢çŸ¥åAIç§‘æŠ€åšä¸»â€”â€”åŒ—é‚®PRISæ¨¡å¼è¯†åˆ«å®éªŒå®¤ é™ˆå…‰æ•™æˆ [@çˆ±å¯å¯-çˆ±ç”Ÿæ´»](https://weibo.com/fly51fly?profile_ftype=1&is_hot=1#_0) å¾®åšæ¨èã€‚

![æ„Ÿè°¢æ•™æˆæ¨è](https://github.com/ChunelFeng/caiss/blob/master/doc/image/Caiss%20Recommend.jpg)

------------
#### é™„å½•-1. ç‰ˆæœ¬ä¿¡æ¯

[2020.06.15 - v1.0.0 - Chunel] 
* æ–°å»ºï¼Œç¬¬ä¸€ä¸ªåŠŸèƒ½ç‰ˆæœ¬
* æä¾›è®­ç»ƒã€æŸ¥è¯¢ã€æ’å…¥ã€ä¿å­˜ç­‰åŠŸèƒ½

[2020.06.25 - v1.2.0 - Chunel]
* æ–°å¢å¤šçº¿ç¨‹åŠŸèƒ½
* æ–°å¢ç¼“å­˜æœºåˆ¶
* æä¾›ç®€å•çš„ä½¿ç”¨demo
* å…¼å®¹macå’ŒLinuxç³»ç»Ÿ

[2020.06.29 - v1.2.1 - Chunel]
* å¼‚æ­¥å¹¶å‘æ¨¡å¼ä¼˜åŒ–

[2020.07.03 - v1.3.0 - Chunel]
* æ–°å¢æ ¹æ®ç¼–è¾‘è·ç¦»çš„è¿‡æ»¤
* æ–°å¢pythonç‰ˆæœ¬ï¼Œæä¾›åŸºç¡€æŸ¥è¯¢åŠŸèƒ½

[2020.07.11 - v1.5.0 - Chunel]
* æ–°å¢è¯è¯­åˆ é™¤åŠŸèƒ½
* æ–°å¢å¹¶è¡Œè®¡ç®—åŠŸèƒ½ï¼Œæå¤§ç¼©çŸ­è®­ç»ƒå’ŒéªŒè¯è€—æ—¶
* åŸºäºpythonç‰ˆæœ¬ï¼Œå¯¹å¤–æä¾›ç½‘ç»œæœåŠ¡

[2020.07.18 - v1.5.1 - Chunel]
* ä¼˜åŒ–å¼‚æ­¥æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼ŒæŸ¥è¯¢å•è¯ä¿¡æ¯å†…å­˜è‡ªåŠ¨é‡Šæ”¾çš„é—®é¢˜

[2020.08.01 - v1.5.2 - Chunel]
* æä¾›å¹¶è¡Œè®¡ç®—æ–¹æ³•ï¼Œè¿›ä¸€æ­¥å‡å°‘æŸ¥è¯¢è€—æ—¶
* è§£å†³è·¨å¹³å°å…¼å®¹æ€§é—®é¢˜

[2020.08.22 - v1.6.0 - Chunel]
* æä¾›é™ç»´ç®—æ³•
* æä¾›é’ˆå¯¹æ–‡æœ¬çš„embeddingå¤„ç†æ–¹æ³•ï¼Œç”¨äºè‡ªè¡Œç”Ÿæˆç¬¦åˆæ ¼å¼çš„è®­ç»ƒæ–‡ä»¶

[2020.08.30 - v2.0.0 - Chunel]
* æä¾›åŸºç¡€SQLè¯­å¥æŸ¥è¯¢åŠŸèƒ½

[2020.09.12 - v2.0.1 - Chunel]
* æä¾›åŸºäºSQLè¯­å¥çš„å¢åˆ æŸ¥æ”¹åŠŸèƒ½
* æä¾›SQLç‰ˆæœ¬çš„ä½¿ç”¨demo

[2020.09.19 - v2.1.0 - Chunel]
* æä¾›Javaç‰ˆæœ¬çš„SDKæ¥å£åŠå…¶å¯¹åº”çš„ä½¿ç”¨demo

[2020.10.01 - v2.2.0 - Chunel]
* ä¼˜åŒ–æ–‡æœ¬è®­ç»ƒæ–¹å¼ï¼Œè§£å†³äº†é’ˆå¯¹tensorflow-v2.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬çš„å…¼å®¹æ€§é—®é¢˜
* æä¾›C#ç‰ˆæœ¬çš„SDKæ¥å£åŠå…¶å¯¹åº”çš„ä½¿ç”¨demo

[2020.10.31 - v2.4.0 - Chunel]
* æä¾›æ‰¹é‡æŸ¥è¯¢åŠŸèƒ½
* ä¼˜åŒ–å†…éƒ¨ç¼“å­˜ç»“æ„
* ä¿®æ”¹è¾“å‡ºjsonæ ¼å¼

[2020.11.15 - v2.4.1 - Chunel]
* æä¾›Linuxä¸­ä¸€é”®å®‰è£…åŠ é€Ÿç¯å¢ƒåŠŸèƒ½
* ä¼˜åŒ–Pythonç‰ˆæœ¬åŠå…¶å¯¹åº”çš„ä½¿ç”¨Demo
* ä¿®å¤å·²çŸ¥é—®é¢˜ï¼Œå¼‚å¸¸æµç¨‹æ·»åŠ ä¸»åŠ¨æŠ¥é”™ä¿¡æ¯ï¼Œä¼˜åŒ–ä½¿ç”¨ä½“éªŒ

[2020.11.21 - v2.5.0 - Chunel]
* æä¾›Dockerç‰ˆæœ¬
* æä¾›é™é»˜è¿è¡ŒåŠŸèƒ½ï¼Œä¼˜åŒ–æç¤ºä¿¡æ¯

[2020.12.13 - v3.0.0 - Chunel]
* æä¾›åŸºäºMRPTç®—æ³•çš„è®­ç»ƒå’ŒæŸ¥è¯¢åŠŸèƒ½
* æ›´æ–°è¾“å‡ºå†…å®¹ï¼ŒåŠ å…¥ç®—æ³•ç±»å‹å’Œè€—æ—¶ä¿¡æ¯

[2021.02.09 - v3.0.1 - [Awind](https://github.com/awind)]
* æä¾›Webé¡µé¢ç‰ˆæœ¬

------------
#### é™„å½•-2. æ¨èé˜…è¯»: 
* [Why Caiss â€”â€” è°ˆè°ˆæˆ‘ä¸ºä»€ä¹ˆè¦åšCaiss](http://www.chunel.cn/archives/whycaiss)
* [What Caissï¼ˆä¸Šï¼‰â€”â€” è°ˆè°ˆæˆ‘åœ¨Caissä¸­ï¼Œåšäº†å“ªäº›ç®—æ³•ä¼˜åŒ–](http://www.chunel.cn/archives/whatcaiss)
* [What Caissï¼ˆä¸­ï¼‰â€”â€” è°ˆè°ˆæˆ‘åœ¨Caissä¸­ï¼Œåšäº†å“ªäº›å·¥ç¨‹ä¼˜åŒ–](http://www.chunel.cn/archives/whatcaiss2)
* [What Caissï¼ˆä¸‹ï¼‰â€”â€” è°ˆè°ˆæˆ‘åœ¨Caissä¸­ï¼Œåšäº†å“ªäº›æœåŠ¡åŒ–å·¥ä½œ](http://www.chunel.cn/archives/whatcaiss3)
* [How Caiss â€”â€” è°ˆè°ˆæˆ‘å®æµ‹çš„Caissçš„æ€§èƒ½æŒ‡æ ‡å¦‚ä½•](http://www.chunel.cn/archives/howcaiss)
* [Where Caiss â€”â€” è°ˆè°ˆæˆ‘å…³äºCaissä¸‹ä¸€æ­¥åšä»€ä¹ˆçš„æƒ³æ³•](http://www.chunel.cn/archives/wherecaiss)

------------
#### é™„å½•-3. è”ç³»æ–¹å¼: 

* å¾®ä¿¡ï¼š ChunelFeng
* é‚®ç®±ï¼š chunel@foxmail.com
* æºç ï¼š https://github.com/ChunelFeng/caiss
* è®ºå›ï¼š www.chunel.cn

![Caiss ä½œè€…å¾®ä¿¡äºŒç»´ç ](https://github.com/ChunelFeng/caiss/blob/master/doc/image/Caiss%20Author.jpg)

